server {
    listen 80;
    server_name {{ edupi_fqdn }} {{ edupi_server_name }};

    set $edupi_home {{ edupi_root }}/;

    # client_max_body_size 500M;

    location /static {
        alias $edupi_home/static;
    }

    location /media {
        access_log /var/log/nginx/edupi_media_access.log;
        alias $edupi_home/media;
    }

    location / {
        proxy_set_header Host $http_host;
        proxy_set_header X-Scheme $scheme;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_pass http://localhost:8010;
        #error_page 502 = @502;
    }

    location @502 {
        types { }
        default_type "text/html";
        return 502 "
        <BR>
        <H1>EduPi might be busy - wait a few moments and then reload this page
        <BR><BR>
        <H2>If EduPi is still busy, get help from the system administrator
        <H3>Error code: nginx 502 Bad Gateway (maybe the EduPi webserver is not working correctly)";
    }

}
